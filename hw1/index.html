<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      h1 {
        text-align: center;
      }

      .container {
        margin: 0 auto;
        padding: 60px 20%;
      }

      figure {
        text-align: center;
      }

      img {
        display: inline-block;
      }

      body {
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>CS184/284A Spring 2025 Homework 1 Write-Up</h1>
      <div style="text-align: center">Names: Sun Jingfeng</div>

      <br />

      Link to webpage:
      <a href="https://jingfengs.github.io/cs184-284a-sp25-hw-webpages/"
        >https://jingfengs.github.io/cs184-284a-sp25-hw-webpages/</a
      >

      <br />

      Link to GitHub repository: (TODO)
      <a href="https://github.com/JingfengS/cs184-284a-sp25-hw-webpages"
        >https://github.com/JingfengS/cs184-284a-sp25-hw-webpages</a
      >

      <figure>
        <img src="lion.jpg" alt="Lion" style="width: 50%" />
      </figure>

      <!--
		We've already added one heading per task, to make your write-up as navigable when grading. Please fit your write-up within these sections!
		-->

      <h2>Overview</h2>
      This is my self-implemented functional vector graphics renderer that can
      take in a simplified version of SVG (Scalable Vector Graphics) file, which
      contains features such as drawing triangles, supersampling, hierarchical
      transforms, and texture mapping with antialiasing.

      <h2>Task 1: Drawing Single-Color Triangles</h2>
      For this task, I first implemented a basic drawing algorithm, which worked
      but slow in speed. Then I made 2 optimazations to make it faster. Finally,
      I used several test images to test my implementation and see significant
      improvement.

      <h3>Basic Implementation</h3>
      Use the 3 vertex points to find out the bounding box of the triangle. Then
      for every pixel inside the bounding box, find out if it is inside the
      triangle by checking its position relative to the 3 edges of the triangle.
      This method is intuitive but lack in efficiency.

      <h3>First Optimization</h3>
      Finding if a single point P is inside the triangle requires checking its
      position relative to 3 edges, which involves 3 cross products and 3
      multiplications. However, for the pixels in the same row or same column,
      its cross products share common terms, which only requires one single
      addition to update from one pixel to its neighbor. To optimize this, I
      precompute the edge functions for the triangle, which allows me to
      iterating over pixels in a scanline order and updating the edge function
      values incrementally. This reduces reduncdant calculations and improves
      efficiency.

      <h3>Second Optimization</h3>
      However, iterating over every pixel in the bounding box is still
      inefficient, especially when the triangle is small compared to the
      bounding box. In the iterating process, I found out that for a line, if it
      enters the triangle and then exit it, all the following pixels in that row
      will be outside the triangle. Therefore, I can break out of the inner loop
      early when I detect that the line has exited the triangle. This
      optimization significantly reduces the number of pixels that need to be
      checked, especially for small triangles.

      <h3>Speed Test results</h3>

      <div style="display: flex; flex-direction: column; align-items: center">
        <table
          style="width: 100%; text-align: center; border-collapse: collapse"
        >
          <tr>
            <td style="text-align: center">
              <img src="assets/task1/dragon.png" width="400px" />
              <figcaption>Basic: 9.1106ms</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task1/dragon.png" width="400px" />
              <figcaption>First Optimization: 7.9026ms</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task1/dragon.png" width="400px" />
              <figcaption>Second Optimization: 6.7875ms</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task1/drawing_sample.png" width="400px" />
              <figcaption>Basic: 66.367ms</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task1/drawing_sample.png" width="400px" />
              <figcaption>First Optimization: 51.139ms</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task1/drawing_sample.png" width="400px" />
              <figcaption>Second Optimization: 30.547ms</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task1/drawing_sample_2.png" width="400px" />
              <figcaption>Basic: 658.75ms</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task1/drawing_sample_2.png" width="400px" />
              <figcaption>First Optimization: 486.67ms</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task1/drawing_sample_2.png" width="400px" />
              <figcaption>Second Optimization: 343.02ms</figcaption>
            </td>
          </tr>
        </table>
      </div>

      <h2>Task 2: Antialiasing by Supersampling</h2>
      <figure>
        <img
          src="assets/task2/super_sampling.png"
          alt="Lion"
          style="width: 50%"
        />
      </figure>
      <h3>Overview</h3>
      In this section, to antialiasing, I implemented supersampling, which
      involves dividing each pixel into a grid of subpixels, sampling the
      subpixels to see if they are covered by any triangle, and averaging the
      colors of the subpixels to determine the final color of the pxiel. By
      doing so, we can achieve smoother edges and reduce aliasing artifacts in
      the rendered image.
      <h3>Data Structures</h3>
      <ul>
        <li>
          <strong>Sample rate:</strong> An integer to indicate the number of
          subpixels per pixel, which takes values of 1, 4, 9 etc.
        </li>
        <li>
          <strong>Samplebuffer:</strong> An array of size (width * height *
          sample_rate) to store the color values of each subpixels.
        </li>
        <li>
          <strong>Framebuffer: </strong> An array of size (width * height) to
          store the resolved color values of each pixel from the sample buffer.
        </li>
      </ul>
      <h3>Implementation Details</h3>
      During the rasterization process, instead of checking if the center of the
      pixel is inside the triangle, I check each subpixel within the pixel. For
      each subpixel, I calculate its position based on the sample rate and
      determine if it is covered by the triangle using the same edge function
      method as in Task 1. If a subpixel is covered, I set its color in the
      sample buffer to the triangle's color. After rasterizing all triangles, I
      resolve the final color of each pixel by averaging the colors of its
      subpixels in the sample buffer. This involves summing up the color values
      of all subpixels within a pixel and dividing by the total number of
      subpixels (i.e., sample rate). The resolved color is then stored in the
      framebuffer, which is used to generate the final output image.

      <h3>Results</h3>
      <div style="display: flex; flex-direction: column; align-items: center">
        <table
          style="width: 100%; text-align: center; border-collapse: collapse"
        >
          <tr>
            <td style="text-align: center">
              <img src="assets/task2/blue-1.png" width="400px" />
              <figcaption>Sample Rate: 1</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task2/blue-4.png" width="400px" />
              <figcaption>Sample Rate: 4</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task2/blue-9.png" width="400px" />
              <figcaption>Sample Rate: 9</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task2/blue-16.png" width="400px" />
              <figcaption>Sample Rate: 16</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task2/red-1.png" width="400px" />
              <figcaption>Sample Rate: 1</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task2/red-4.png" width="400px" />
              <figcaption>Sample Rate: 4</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task2/red-9.png" width="400px" />
              <figcaption>Sample Rate: 9</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task2/red-16.png" width="400px" />
              <figcaption>Sample Rate: 16</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task2/green-1.png" width="400px" />
              <figcaption>Sample Rate: 1</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task2/green-4.png" width="400px" />
              <figcaption>Sample Rate: 4</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="assets/task2/green-9.png" width="400px" />
              <figcaption>Sample Rate: 9</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task2/green-16.png" width="400px" />
              <figcaption>Sample Rate: 16</figcaption>
            </td>
          </tr>
        </table>
      </div>
      <p>
        <strong
          >As the sample rate increases, the image becomes less pixelated and
          smoother.</strong
        >
      </p>

      <h2>Task 3: Transforms</h2>
      <h3>Overview</h3>
      In this task, I added transform features to the renderer. Including
      translation, scaling, and rotation. In addition to that, you can use `R`
      to rotate the whole image.
			<h3>Results</h3>
			<div style="display: flex; flex-direction: column; align-items: center">
        <table
          style="width: 100%; text-align: center; border-collapse: collapse"
        >
          <tr>
            <td style="text-align: center">
              <img src="assets/task3/robot.png" width="400px" />
              <figcaption>Robot</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task3/robot-waiving.png" width="400px" />
              <figcaption>Robot Waiving (Change the svg file)</figcaption>
            </td>
            <td style="text-align: center">
              <img src="assets/task3/rotate.png" width="400px" />
              <figcaption>Extra: Rotate the whole image</figcaption>
            </td>
          </tr>
        </table>
      </div>


      <h2>Task 4: Barycentric coordinates</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Task 5: "Pixel sampling" for texture mapping</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Task 6: "Level Sampling" with mipmaps for texture mapping</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>(Optional) Task 7: Extra Credit - Draw Something Creative!</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Additional Notes (please remove)</h2>
      <ul>
        <li>
          You can also add code if you'd like as so: <code>code code code</code>
        </li>
        <li>
          If you'd like to add math equations,
          <ul>
            <li>
              You can write inline equations like so: \( a^2 + b^2 = c^2 \)
            </li>
            <li>
              You can write display equations like so: \[ a^2 + b^2 = c^2 \]
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </body>
</html>
